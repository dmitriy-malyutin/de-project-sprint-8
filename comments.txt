Кирилл, привет!
Спасибо за разбор. Постарался учесть все твои комментарии.

По поводу дедупликации - функция subscribers_restaurants возвращает дедуплицированный датафрейм, который позднее джойнится со стримом и попадает в result